<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Architecture &mdash; climlab 0.3.2 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="climlab 0.3.2 documentation" href="index.html" />
    <link rel="next" title="Models" href="models.html" />
    <link rel="prev" title="Download" href="download.html" /> 
  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="sampledoc"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="models.html" title="Models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="download.html" title="Download"
             accesskey="P">previous</a> |</li>
        <li><a href="intro.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
        <!-- 
	<li><a href="contents.html">documentation </a> &raquo;</li>
	-->
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="download.html">Download</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#process">Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="#domain">Domain</a></li>
<li class="toctree-l2"><a class="reference internal" href="#axis">Axis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessibility">Accessibility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/climlab.html">Application Programming Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/architecture.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="architecture">
<h1>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h1>
<p>The backbone of the climlab architecture are <cite>Processes</cite> and their relatives <cite>TimeDependentProcesses</cite>. As all relevant procedures and events that can be modelled with <cite>climlab</cite> are expressed in <cite>Processes</cite>, they build the basic structure of the package.</p>
<p>For example, if you want to model the incoming solar radiation on Earth, <cite>climlab</cite> implements it as a <cite>Process</cite>, namely in the <cite>Diagnostic Process</cite> <a class="reference internal" href="api/climlab.radiation.html#climlab.radiation.insolation._Insolation" title="climlab.radiation.insolation._Insolation"><code class="xref py py-class docutils literal"><span class="pre">_Insolation</span></code></a> (or one of it&#8217;s daughter classes to be specific).</p>
<p>Another example: the emitted energy of a surface can be computed through  the <a class="reference internal" href="api/climlab.radiation.html#climlab.radiation.Boltzmann.Boltzmann" title="climlab.radiation.Boltzmann.Boltzmann"><code class="xref py py-class docutils literal"><span class="pre">Boltzmann</span></code></a> class which is also a climlab <cite>Process</cite> and implements the Stefan Boltzmann Law for a grey body. Like that, all events and procedures that <cite>climlab</cite> can model are organized in <cite>Processes</cite>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The implementation of a whole model, for example an Energy Balance Model (<a class="reference internal" href="api/climlab.model.html#climlab.model.ebm.EBM" title="climlab.model.ebm.EBM"><code class="xref py py-class docutils literal"><span class="pre">EBM</span></code></a>), is also an instance of the <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a> class in <cite>climlab</cite>.</p>
<p class="last">For more information about models, see the climlab <a class="reference internal" href="models.html#models"><span>Models</span></a> chapter.</p>
</div>
<p>A <cite>Process</cite> that represents a whole model will have a couple of <cite>subprocesses</cite> which will be <cite>Processes</cite> themselves. They represent a certain part of the model, for example the albedo or the insolation component. More details about subprocesses can be found below.</p>
<p>A <strong>Process</strong> is always defined on a <strong>Domain</strong> which itself is based on <strong>Axes</strong> or a single <strong>Axis</strong>. The following section will give a basic introduction about their role in the package, their dependencies and their implementation.</p>
<div class="section" id="process">
<span id="process-architecture"></span><h2>Process<a class="headerlink" href="#process" title="Permalink to this headline">¶</a></h2>
<p>A process is an instance of the class <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a>. Most processes are timedependent and therefore an instance of the daughter class <a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess" title="climlab.process.time_dependent_process.TimeDependentProcess"><code class="xref py py-class docutils literal"><span class="pre">TimeDependentProcess</span></code></a>.</p>
<div class="section" id="basic-dictionaries">
<h3>Basic Dictionaries<a class="headerlink" href="#basic-dictionaries" title="Permalink to this headline">¶</a></h3>
<p>A <cite>climlab.Process</cite> object has several iterable dictionaries (<a class="reference external" href="http://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a>) of named, gridded variables <a class="footnote-reference" href="#id2" id="id1">[1]</a>:</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">process.state</span></code></dt>
<dd><p class="first last">contains the <cite>process</cite>&#8216; state variables, which are usually time-dependent and which are major quantities that identify the condition and status of the <cite>process</cite>. This can be the (surface) temperature of a model for instance.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">process.input</span></code></dt>
<dd><p class="first last">contains boundary conditions and other gridded quantities independent of the <cite>process</cite>. This dictionary is often set by a parent <cite>process</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">process.param</span></code></dt>
<dd><p class="first last">contains parameter of the <cite>Process</cite> or model. Basically, this is the same as <code class="docutils literal"><span class="pre">process.input</span></code> but with scalar entries.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">process.tendencies</span></code></dt>
<dd><p class="first">is an iterable dictionary of time tendencies <span class="math">\((d/dt)\)</span> for each state variable defined in <code class="docutils literal"><span class="pre">process.state</span></code>.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A non TimeDependentProcess (but instance of <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a>) does not have this dictionary.</p>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">process.diagnostics</span></code></dt>
<dd><p class="first last">contains any quantity derived from the current state. In an Energy Balance Model this dictionary can have entries like <code class="docutils literal"><span class="pre">'ASR'</span></code>, <code class="docutils literal"><span class="pre">'OLR'</span></code>, <code class="docutils literal"><span class="pre">'icelat'</span></code>, <code class="docutils literal"><span class="pre">'net_radiation'</span></code>, <code class="docutils literal"><span class="pre">'albedo'</span></code> or <code class="docutils literal"><span class="pre">'insolation'</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">process.subprocess</span></code></dt>
<dd><p class="first last">holds subprocesses of the <cite>process</cite>. More about subprocesses is described below.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>The <cite>process</cite> is fully described by contents of <cite>state</cite>, <cite>input</cite> and <cite>param</cite>
dictionaries. <cite>tendencies</cite> and <cite>diagnostics</cite> are always computable from the current
state.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>In the following the small written <cite>process</cite> refers to an instance of the <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a> class.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="subprocesses">
<h3>Subprocesses<a class="headerlink" href="#subprocesses" title="Permalink to this headline">¶</a></h3>
<p>Subprocesses are representing and modeling certain components of the parent process. A model consists of many subprocesses which are usually defined on the same state variables, domains and axes as the parent process, at least partially.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><p class="first">The subprocess tree of an EBM may look like this:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="n">model_EBM</span>               <span class="c1">#&lt;head process&gt;</span>
   <span class="n">diffusion</span>            <span class="c1">#&lt;subprocess&gt;</span>
   <span class="n">LW</span>                   <span class="c1">#&lt;subprocess&gt;</span>
   <span class="n">albedo</span>               <span class="c1">#&lt;subprocess&gt;</span>
      <span class="n">iceline</span>           <span class="c1">#&lt;sub-subprocess&gt;</span>
      <span class="n">cold_albedo</span>       <span class="c1">#&lt;sub-subprocess&gt;</span>
      <span class="n">warm_albedo</span>       <span class="c1">#&lt;sub-subprocess&gt;</span>
   <span class="n">insolation</span>           <span class="c1">#&lt;subprocess&gt;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>It can be seen that subprocesses can have subprocesses themselves, like <code class="docutils literal"><span class="pre">albedo</span></code> in this case.</p>
<p>A <code class="docutils literal"><span class="pre">subprocess</span></code> is similar to its <code class="docutils literal"><span class="pre">parent</span> <span class="pre">process</span></code> an instance of the <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a> class. That means a <code class="docutils literal"><span class="pre">subprocess</span></code> has dictionaries and attributes with the same names as its <code class="docutils literal"><span class="pre">parent</span> <span class="pre">process</span></code>. Not necessary all will be the same or have the same entries, but a <code class="docutils literal"><span class="pre">subprocess</span></code> has at least the basic dictionaries and attributes created during initialization of the <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a> instance.</p>
<p>Every <cite>subprocess</cite> should work independently of its <cite>parent process</cite> given
appropriate <cite>input</cite>.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><p class="first">Investigating an individual <cite>process</cite> (possibly with its own <cite>subprocesses</cite>) isolated from its parent can be done through:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">newproc</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">procname</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;subprocname&#39;</span><span class="p">])</span>
<span class="n">newproc</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
<p class="last">Thereby anything in the <cite>input</cite> dictionary of <code class="docutils literal"><span class="pre">'subprocname'</span></code> will remain fixed.</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="process-integration-over-time">
<h3>Process Integration over time<a class="headerlink" href="#process-integration-over-time" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess" title="climlab.process.time_dependent_process.TimeDependentProcess"><code class="xref py py-class docutils literal"><span class="pre">TimeDependentProcess</span></code></a> can be integrated over time to see how the state variables and other diagnostic variables vary in time.</p>
<div class="section" id="time-dependency-of-a-state-variable">
<h4>Time Dependency of a State Variable<a class="headerlink" href="#time-dependency-of-a-state-variable" title="Permalink to this headline">¶</a></h4>
<p>For a state variable <span class="math">\(S\)</span> which is dependendet on processes <span class="math">\(P_A\)</span>, <span class="math">\(P_B\)</span>, ... the time dependency can be written as</p>
<div class="math">
\[\frac{dS}{dt} = \underbrace{P_A(S)}_{S \textrm{ tendency by }P_A} + \underbrace{P_B(S)}_{S \textrm{ tendency by } P_B} + \ ...\]</div>
<p>When the state variable <span class="math">\(S\)</span> is discretized over time like</p>
<div class="math">
\[\frac{dS}{dt} = \frac{\Delta S}{\Delta t} = \frac{S(t_1) - S(t_0)}{t_1 - t_0} = \frac{S_1 - S_0}{\Delta t} ~,\]</div>
<p>the state tendency can be calculated through</p>
<div class="math">
\[\Delta S = \big[ P_A(S) + P_B(S) + \ ... \big] \Delta t\]</div>
<p>and the new state of <span class="math">\(S\)</span> after one timestep <span class="math">\(\Delta t\)</span> is then:</p>
<div class="math">
\[S_1 = S_0 + \big[ \underbrace{P_A(S)}_{S \textrm{ tendency by }P_A} + \underbrace{P_B(S)}_{S \textrm{ tendency by }P_B} + \ ... \ \big] \Delta t  ~.\]</div>
<p>Therefore, the new state of <span class="math">\(S\)</span> is calculated by multiplying the process tendencies of <span class="math">\(S\)</span> with the timestep and adding them up to the previous state of <span class="math">\(S\)</span>.</p>
</div>
<div class="section" id="time-dependency-of-an-energy-budget">
<h4>Time Dependency of an Energy Budget<a class="headerlink" href="#time-dependency-of-an-energy-budget" title="Permalink to this headline">¶</a></h4>
<p>The time dependency of an EBM energy budget is very similar to the above noted equations, just differing in a heat capacity factor <span class="math">\(C\)</span>. The state variable is temperature <span class="math">\(T\)</span> in this case, which is altered by subprocesses <span class="math">\(SP_A\)</span>, <span class="math">\(SP_B\)</span>, ...</p>
<div class="math">
\[\begin{split}\frac{dE}{dt} = C \frac{dT}{dt} = \underbrace{SP_A(T)}_{\textrm{heating-rate of }SP_A} + \underbrace{SP_B(T)}_{\textrm{ heating-rate of }SP_B} + \ ...                          \\
\Leftrightarrow   \frac{dT}{dt} = \underbrace{\frac{SP_A(T)}{C}}_{T \textrm{ tendency by }SP_A} + \underbrace{\frac{SP_B(T)}{C}}_{T \textrm{ tendency by }SP_B} + \ ...\end{split}\]</div>
<p>Therefore, the new state of <span class="math">\(T\)</span> after one timestep <span class="math">\(\Delta t\)</span> can be written as:</p>
<div class="math">
\[T_1 = \underbrace{T_0 + \underbrace{ \left[ \frac{SP_A(T)}{C} + \frac{SP_B(T)}{C} + \ ... \right]}_{\textrm{compute()}}  \Delta t }_{\textrm{step\_forward()}}\]</div>
<p>The integration procedure is implemented in multiple nested function calls. The top functions for model integration are explained here, for details about computation of subprocess tendencies see <a class="reference internal" href="#classification-of-subprocess-types">Classification of Subprocess Types</a> below.</p>
<ul>
<li><dl class="first docutils">
<dt><a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.compute" title="climlab.process.time_dependent_process.TimeDependentProcess.compute"><code class="xref py py-class docutils literal"><span class="pre">compute()</span></code></a> is a method that computes tendencies <span class="math">\(d/dt\)</span> for all state variables</dt>
<dd><ul class="first last">
<li><p class="first">it returns a dictionary of tendencies for all state variables</p>
<blockquote>
<div><p>Temperature tendencies are <span class="math">\(\frac{SP_A(T)}{C}\)</span>, <span class="math">\(\frac{SP_B(T)}{C}\)</span>, ... in this case, which are summed up like:</p>
<div class="math">
\[\textrm{tendencies}(T) = \frac{SP_A(T)}{C} + \frac{SP_B(T)}{C} + ...\]</div>
</div></blockquote>
</li>
<li><p class="first">the keys for this dictionary are the same as keys of state dictionary</p>
<blockquote>
<div><p>As temperature <span class="math">\(T\)</span> is the only state variable in this energy budget, the tendencies dictionary also just has the one key, representing the state variable <span class="math">\(T\)</span>.</p>
</div></blockquote>
</li>
<li><p class="first">the tendency dictionary holds the total tendencies for each state including all subprocesses</p>
<blockquote>
<div><p>In case subprocess <span class="math">\(SP_A\)</span> itself has subprocesses, their <span class="math">\(T\)</span> tendencies get included in tendency computation by <a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.compute" title="climlab.process.time_dependent_process.TimeDependentProcess.compute"><code class="xref py py-class docutils literal"><span class="pre">compute()</span></code></a>.</p>
</div></blockquote>
</li>
<li><p class="first">the method only computes <span class="math">\(d/dt\)</span> but <strong>does not apply changes</strong> (which is done by <a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.step_forward" title="climlab.process.time_dependent_process.TimeDependentProcess.step_forward"><code class="xref py py-class docutils literal"><span class="pre">step_forward()</span></code></a>)</p>
</li>
<li><p class="first">therefore, the method is relatively independent of the numerical scheme</p>
</li>
<li><p class="first">method <strong>will update</strong> variables in <code class="docutils literal"><span class="pre">proc.diagnostic</span></code> dictionary. Therefore, it will also <strong>gather all diagnostics</strong> from the <cite>subprocesses</cite></p>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.step_forward" title="climlab.process.time_dependent_process.TimeDependentProcess.step_forward"><code class="xref py py-class docutils literal"><span class="pre">step_forward()</span></code></a> updates the state variables</dt>
<dd><ul class="first last simple">
<li>it calls <a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.compute" title="climlab.process.time_dependent_process.TimeDependentProcess.compute"><code class="xref py py-class docutils literal"><span class="pre">compute()</span></code></a> to get current tendencies</li>
<li>the method multiplies state tendencies with the timestep and adds them up to the state variables</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first"><a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.integrate_years" title="climlab.process.time_dependent_process.TimeDependentProcess.integrate_years"><code class="xref py py-class docutils literal"><span class="pre">integrate_years()</span></code></a> etc will automate time-stepping by calling the <a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.step_forward" title="climlab.process.time_dependent_process.TimeDependentProcess.step_forward"><code class="xref py py-class docutils literal"><span class="pre">step_forward</span></code></a> method multiple times. It also does the computation of time-average diagnostics.</p>
</li>
<li><p class="first"><a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.integrate_converge" title="climlab.process.time_dependent_process.TimeDependentProcess.integrate_converge"><code class="xref py py-class docutils literal"><span class="pre">integrate_converge()</span></code></a> calls <a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.integrate_years" title="climlab.process.time_dependent_process.TimeDependentProcess.integrate_years"><code class="xref py py-class docutils literal"><span class="pre">integrate_years()</span></code></a> as long as the state variables keep changing over time.</p>
</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><p class="first">Integration of a <cite>climlab</cite> EBM model over time can look like this:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">climlab</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM</span><span class="p">()</span>

<span class="c1"># integrate the model for one year</span>
<span class="n">model</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="classification-of-subprocess-types">
<h4>Classification of Subprocess Types<a class="headerlink" href="#classification-of-subprocess-types" title="Permalink to this headline">¶</a></h4>
<p>Processes can be classified in types: <cite>explicit</cite>, <cite>implicit</cite>, <cite>diagnostic</cite> and <cite>adjustment</cite>.
This makes sense as subprocesses may have different impact on state variable tendencies (<cite>diagnostic</cite> processes don&#8217;t have a direct influence for instance) or the way their tendencies are computed differ (<cite>explixit</cite> and <cite>implicit</cite>).</p>
<p>Therefore, the <a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.compute" title="climlab.process.time_dependent_process.TimeDependentProcess.compute"><code class="xref py py-class docutils literal"><span class="pre">compute()</span></code></a> method handles them seperately as well as in specific order. It calls private <code class="xref py py-func docutils literal"><span class="pre">_compute()</span></code> methods that are specified in daugther classes of <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a> namely <a class="reference internal" href="api/climlab.process.html#climlab.process.diagnostic.DiagnosticProcess" title="climlab.process.diagnostic.DiagnosticProcess"><code class="xref py py-class docutils literal"><span class="pre">DiagnosticProcess</span></code></a>,
<a class="reference internal" href="api/climlab.process.html#climlab.process.energy_budget.EnergyBudget" title="climlab.process.energy_budget.EnergyBudget"><code class="xref py py-class docutils literal"><span class="pre">EnergyBudget</span></code></a> (which are explicit processes) or
<a class="reference internal" href="api/climlab.process.html#climlab.process.implicit.ImplicitProcess" title="climlab.process.implicit.ImplicitProcess"><code class="xref py py-class docutils literal"><span class="pre">ImplicitProcess</span></code></a>.</p>
<p>The description of <a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.compute" title="climlab.process.time_dependent_process.TimeDependentProcess.compute"><code class="xref py py-class docutils literal"><span class="pre">compute()</span></code></a> reveals the details how the different process types are handeled:</p>
<blockquote>
<div><p>The function first computes all diagnostic processes. They don&#8217;t produce
any tendencies directly but they may effect the other processes (such as
change in solar distribution). Subsequently, all tendencies and diagnostics
for all explicit processes are computed.</p>
<p>Tendencies due to implicit and adjustment processes need to be
calculated from a state that is already adjusted after explicit
alteration. For that reason the explicit tendencies are applied to the states
temporarily. Now all tendencies from implicit processes are calculated
by matrix inversions and similar to the explicit tendencies, the implicit ones
are applied to the states temporarily. Subsequently, all instantaneous adjustments
are computed.</p>
<p>Then the changes that were made to the states from explicit and implicit
processes are removed again as this
<a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.compute" title="climlab.process.time_dependent_process.TimeDependentProcess.compute"><code class="xref py py-class docutils literal"><span class="pre">compute()</span></code></a>
function is
supposed to calculate only tendencies and not apply them to the states.</p>
<p>Finally, all calculated tendencies from all processes are collected
for each state, summed up and stored in the dictionary
<code class="docutils literal"><span class="pre">self.tendencies</span></code>, which is an attribute of the time-dependent-process
object, for which the
<a class="reference internal" href="api/climlab.process.html#climlab.process.time_dependent_process.TimeDependentProcess.compute" title="climlab.process.time_dependent_process.TimeDependentProcess.compute"><code class="xref py py-class docutils literal"><span class="pre">compute()</span></code></a>
method has been called.</p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="domain">
<h2>Domain<a class="headerlink" href="#domain" title="Permalink to this headline">¶</a></h2>
<p>A <cite>Domain</cite> defines an area or spatial base for a climlab <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a> object. It consists of axes which
are <a class="reference internal" href="api/climlab.domain.html#climlab.domain.axis.Axis" title="climlab.domain.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> objects that define the dimensions of the <cite>Domain</cite>.</p>
<p>In a <cite>Domain</cite> the heat capacity of grid points, bounds or cells/boxes is specified.</p>
<p>There are daughter classes <a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain.Atmosphere" title="climlab.domain.domain.Atmosphere"><code class="xref py py-class docutils literal"><span class="pre">Atmosphere</span></code></a> and <a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain.Ocean" title="climlab.domain.domain.Ocean"><code class="xref py py-class docutils literal"><span class="pre">Ocean</span></code></a> of the private <a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain._Domain" title="climlab.domain.domain._Domain"><code class="xref py py-class docutils literal"><span class="pre">_Domain</span></code></a> class implemented which themselves have daughter classes <a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain.SlabAtmosphere" title="climlab.domain.domain.SlabAtmosphere"><code class="xref py py-class docutils literal"><span class="pre">SlabAtmosphere</span></code></a> and <a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain.SlabOcean" title="climlab.domain.domain.SlabOcean"><code class="xref py py-class docutils literal"><span class="pre">SlabOcean</span></code></a>.</p>
<p>Every <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a> needs to be defined on a <cite>Domain</cite>. If none is given during initialization but latitude <code class="docutils literal"><span class="pre">lat</span></code> is specified, a default <cite>Domain</cite> is created.</p>
<p>Several methods are implemented that create <cite>Domains</cite> with special specifications. These are</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain.single_column" title="climlab.domain.domain.single_column"><code class="xref py py-func docutils literal"><span class="pre">single_column()</span></code></a></li>
<li><a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain.zonal_mean_column" title="climlab.domain.domain.zonal_mean_column"><code class="xref py py-func docutils literal"><span class="pre">zonal_mean_column()</span></code></a></li>
<li><a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain.box_model_domain" title="climlab.domain.domain.box_model_domain"><code class="xref py py-func docutils literal"><span class="pre">box_model_domain()</span></code></a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="axis">
<h2>Axis<a class="headerlink" href="#axis" title="Permalink to this headline">¶</a></h2>
<p>An <a class="reference internal" href="api/climlab.domain.html#climlab.domain.axis.Axis" title="climlab.domain.axis.Axis"><code class="xref py py-class docutils literal"><span class="pre">Axis</span></code></a> is an object where information of a <a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain._Domain" title="climlab.domain.domain._Domain"><code class="xref py py-class docutils literal"><span class="pre">_Domain</span></code></a>&#8216;s spacial dimension are specified.</p>
<p>These include the <cite>type</cite> of the axis, the <cite>number of points</cite>, location of <cite>points</cite> and <cite>bounds</cite> on the spatial dimension, magnitude of bounds differences <cite>delta</cite> as well as their <cite>unit</cite>.</p>
<p>The <cite>axes</cite> of a <a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain._Domain" title="climlab.domain.domain._Domain"><code class="xref py py-class docutils literal"><span class="pre">_Domain</span></code></a> are stored in the dictionary axes, so they can be accessed through <code class="docutils literal"><span class="pre">dom.axes</span></code> if <code class="docutils literal"><span class="pre">dom</span></code> is an instance of <a class="reference internal" href="api/climlab.domain.html#climlab.domain.domain._Domain" title="climlab.domain.domain._Domain"><code class="xref py py-class docutils literal"><span class="pre">_Domain</span></code></a>.</p>
</div>
<div class="section" id="accessibility">
<h2>Accessibility<a class="headerlink" href="#accessibility" title="Permalink to this headline">¶</a></h2>
<p>For convenience with interactive work, each subprocess <code class="docutils literal"><span class="pre">'name'</span></code> should be accessible
as <code class="docutils literal"><span class="pre">proc.subprocess.name</span></code> as well as the regular way through the subprocess dictionary <code class="docutils literal"><span class="pre">proc.subprocess['name']</span></code>. Note that <code class="docutils literal"><span class="pre">proc</span></code> is an instance of the <a class="reference internal" href="api/climlab.process.html#climlab.process.process.Process" title="climlab.process.process.Process"><code class="xref py py-class docutils literal"><span class="pre">Process</span></code></a> class here.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">climlab</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM</span><span class="p">()</span>

<span class="c1"># quick access</span>
<span class="n">longwave_subp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">LW</span>

<span class="c1"># regular path</span>
<span class="n">longwave_subp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;LW&#39;</span><span class="p">]</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p><cite>climlab</cite> will remain (as much as possible) agnostic about the data formats. Variables within the dictionaries will behave as <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.10)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> objects.</p>
<p>Grid information and other domain details are accessible as attributes of each process.
These attributes are <code class="docutils literal"><span class="pre">lat</span></code>, <code class="docutils literal"><span class="pre">lat_bounds</span></code>, <code class="docutils literal"><span class="pre">lon</span></code>, <code class="docutils literal"><span class="pre">lon_bounds</span></code>, <code class="docutils literal"><span class="pre">lev</span></code>, <code class="docutils literal"><span class="pre">lev_bounds</span></code>, <code class="docutils literal"><span class="pre">depth</span></code> and <code class="docutils literal"><span class="pre">depth_bounds</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><p class="first">the latitude points of a <cite>process</cite> object that is describing an EBM model</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">climlab</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM</span><span class="p">()</span>

<span class="c1"># quick access</span>
<span class="n">lat_points</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">lat</span>

<span class="c1"># regular path</span>
<span class="n">lat_points</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">domains</span><span class="p">[</span><span class="s1">&#39;Ts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">points</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Shortcuts like <code class="docutils literal"><span class="pre">proc.lat</span></code> will work where these are unambiguous, which means there is only a single axis of that type in the process.</p>
<p>Many variables will be accessible as process attributes <code class="docutils literal"><span class="pre">proc.name</span></code>. This restricts to unique field names in the above dictionaries.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>There may be other dictionaries that do have name conflicts: e.g. dictionary of tendencies <code class="docutils literal"><span class="pre">proc.tendencies</span></code>, with same keys as <code class="docutils literal"><span class="pre">proc.state</span></code>.</p>
<p class="last">These will <strong>not be accessible</strong> as <code class="docutils literal"><span class="pre">proc.name</span></code>, but <strong>will be accessible</strong> as <code class="docutils literal"><span class="pre">proc.dict_name.name</span></code> (as well as regular dictionary interface <code class="docutils literal"><span class="pre">proc.dict_name['name']</span></code>).</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="models.html" title="Models"
             >next</a> |</li>
        <li class="right" >
          <a href="download.html" title="Download"
             >previous</a> |</li>
        <li><a href="intro.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
        <!-- 
	<li><a href="contents.html">documentation </a> &raquo;</li>
	-->
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016 (licensed under MIT License), Moritz Kreuzer &amp; Brian Rose.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>